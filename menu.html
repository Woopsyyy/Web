<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brewlen's Cafe - Menu</title>
    <link href="Bootstrap/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="Images/cafe logo.jpg" alt="Josh's Cafe" class="navbar-img">
      </a>
      
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link active" href="menu.html">MENU</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="branch.html">BRANCH</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">ABOUT</a>
          </li>
        </ul>
        
        <div class="navbar-nav" id="authSection">
          <!-- This will be populated by JavaScript based on auth status -->
        </div>
        <div class="navbar-nav">
          <a class="nav-link" href="#" onclick="showCart()" title="View Cart">
            <i class="fas fa-shopping-cart"></i>
            <span id="cartCount" class="badge bg-primary ms-1">0</span>
          </a>
          <a class="nav-link" href="#" onclick="showFavorites()" title="View Favorites">
            <i class="fas fa-heart"></i>
            <span id="favoritesCount" class="badge bg-danger ms-1">0</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <div class="menu-hero">
    <div class="container">
      <h1>Our Menu</h1>
      <p>Discover our carefully crafted dishes, made with the finest ingredients and prepared with love</p>
    </div>
  </div>

  <!-- Menu Layout with Left Sidebar -->
  <div class="menu-layout py-4">
    <div class="container">
      <div class="row">
        <!-- Left Sidebar Categories -->
        <aside class="col-lg-3 d-none d-lg-block">
          <nav class="left-category-nav">
            <div class="category-group">
              <h6>FOOD</h6>
              <a class="nav-link active" href="#" data-filter="food">All Food</a>
              <a class="nav-link" href="#" data-filter="chicken">Chicken</a>
              <a class="nav-link" href="#" data-filter="pork">Pork</a>
              <a class="nav-link" href="#" data-filter="beef">Beef</a>
              <a class="nav-link" href="#" data-filter="appetizers">Appetizers</a>
              <a class="nav-link" href="#" data-filter="desserts">Desserts</a>
              <a class="nav-link" href="#" data-filter="fruits">Fruits</a>
              <a class="nav-link" href="#" data-filter="bake-in">Bake - In</a>
            </div>
            <div class="category-group mt-3">
              <h6>DRINKS</h6>
              <a class="nav-link" href="#" data-filter="drinks">All Drinks</a>
              <a class="nav-link" href="#" data-filter="brewed">Brewed Coffee</a>
              <a class="nav-link" href="#" data-filter="blended">Blended Beverage</a>
              <a class="nav-link" href="#" data-filter="tea">Teavana Tea</a>
              <a class="nav-link" href="#" data-filter="chocolate">Chocolate & More</a>
            </div>
          </nav>
        </aside>

        <!-- Right Content -->
        <div class="col-lg-9">
          <!-- Search Container -->
          <div class="search-container">
            <div class="row justify-content-center">
              <div class="col-md-10">
                <div class="text-center mb-3">
                  <h4>Search Our Menu</h4>
                  <p class="text-muted">Find your favorite dishes quickly and easily</p>
                </div>
                <input type="text" 
                       id="Search" 
                       class="form-control search-input" 
                       placeholder="Search for food, drinks, or ingredients...">
              </div>
            </div>
          </div>

          <!-- Menu Container -->
          <div class="menu-container">
            <div class="container p-0">
              <!-- Main Dishes Section -->
              <div class="menu-section" id="mainSection">
                <h2 class="section-title">Main Dishes</h2>
                <div class="menu-grid" id="mainGrid"></div>
              </div>

              <!-- Appetizers Section -->
              <div class="menu-section" id="appetizerSection">
                <h2 class="section-title">Appetizers</h2>
                <div class="menu-grid" id="appetizerGrid"></div>
              </div>

              <!-- Desserts Section -->
              <div class="menu-section" id="dessertSection">
                <h2 class="section-title">Desserts</h2>
                <div class="menu-grid" id="dessertGrid"></div>
              </div>

              <!-- Beverages Section -->
              <div class="menu-section" id="beverageSection">
                <h2 class="section-title">Beverages</h2>
                <div class="menu-grid" id="beverageGrid"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Modal for Menu Items -->
  <div class="modal fade" id="modal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="modalTitle">Dish Details</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-5">
              <div class="modal-visual">
                <div class="modal-img-wrap p-3">
                  <img id="modalImg" src="" alt="Dish Image" class="modal-image">
                </div>
              </div>
            </div>
            <div class="col-md-7 modal-details">
              <h3 id="modalItemTitle" class="mb-2 text-primary"></h3>
              <div class="calories-badge mb-3"><span id="modalCalories"></span> calories</div>
              <p id="modalDesc" class="mb-4 lead"></p>
              <div class="mb-2">
                <h6 class="text-muted mb-2">You may also like</h6>
                <div class="row g-3" id="suggestionsRow"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="Bootstrap/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
  
  <!-- Authentication and Menu Script -->
  <script>
    // Check authentication status on page load
    document.addEventListener('DOMContentLoaded', function() {
      checkAuthStatus();
      loadMenuItems();
      setupCategoryNavigation();
      // Apply initial filter to show Food by default
      filterItems('food');
      updateCartCount();
      updateFavoritesCount();
    });

    // Check if user is authenticated
    async function checkAuthStatus() {
      try {
        const response = await fetch('Backend/auth.php?action=check_session');
        const result = await response.json();
        
        if (result.success) {
          // User is logged in
          showAuthenticatedUser(result.data.user);
          // Store user info in localStorage for cart/favorites functionality
          localStorage.setItem('user', JSON.stringify(result.data.user));
        } else {
          // User is not logged in, show login link
          showLoginLink();
          localStorage.removeItem('user');
        }
      } catch (error) {
        console.error('Auth check error:', error);
        // Show login link on error
        showLoginLink();
        localStorage.removeItem('user');
      }
    }

    // Show login link for unauthenticated users
    function showLoginLink() {
      const authSection = document.getElementById('authSection');
      authSection.innerHTML = `
        <div class="nav-item">
          <a class="nav-link" href="login.html">Login</a>
        </div>
      `;
    }

    // Show authenticated user section
    function showAuthenticatedUser(user) {
      const authSection = document.getElementById('authSection');
      authSection.innerHTML = `
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
            <img src="${user.profile_picture || 'Images/logo.jpg'}" alt="Profile" class="rounded-circle me-2" style="width: 24px; height: 24px; object-fit: cover;">
            ${user.name}
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="profile.html">Profile</a></li>
            <li><a class="dropdown-item" href="orders.html">My Orders</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#" onclick="logout()">Logout</a></li>
          </ul>
        </div>
      `;
    }

    // Logout function
    async function logout() {
      try {
        const response = await fetch('Backend/auth.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: 'action=logout'
        });
        
        const result = await response.json();
        if (result.success) {
          // Clear localStorage
          localStorage.removeItem('user');
          localStorage.removeItem('cart');
          localStorage.removeItem('favorites');
          window.location.href = 'index.html';
        }
      } catch (error) {
        console.error('Logout error:', error);
        // Clear localStorage even on error
        localStorage.removeItem('user');
        localStorage.removeItem('cart');
        localStorage.removeItem('favorites');
        window.location.href = 'index.html';
      }
    }

    // Setup category navigation
    function setupCategoryNavigation() {
      // Top bar no longer used; wire left sidebar
      document.querySelectorAll('.left-category-nav .nav-link').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          document.querySelectorAll('.left-category-nav .nav-link').forEach(l => l.classList.remove('active'));
          this.classList.add('active');
          const filter = this.dataset.filter;
          filterItems(filter);
        });
      });
    }

    // Show specific category
    function showCategory(category) {
      const sections = ['main', 'appetizer', 'dessert', 'beverage'];
      if (category === 'all') {
        sections.forEach(section => {
          document.getElementById(section + 'Section').style.display = 'block';
        });
      } else {
        sections.forEach(section => {
          const element = document.getElementById(section + 'Section');
          element.style.display = section === category ? 'block' : 'none';
        });
      }
    }

    // Sidebar filter logic
    function filterItems(filter) {
      // Show all sections by default
      showCategory('all');
      const allCards = document.querySelectorAll('.menu-card');
      const sections = [
        { id: 'mainSection', grid: 'mainGrid' },
        { id: 'appetizerSection', grid: 'appetizerGrid' },
        { id: 'dessertSection', grid: 'dessertGrid' },
        { id: 'beverageSection', grid: 'beverageGrid' }
      ];
      if (!filter || filter === 'food' || filter === 'drinks') {
        allCards.forEach(card => {
          const isDrink = card.dataset.type === 'drink';
          const isFood = card.dataset.type === 'food';
          const shouldShow = (filter === 'food' && isFood) || (filter === 'drinks' && isDrink) || (!filter);
          card.style.display = shouldShow ? 'block' : 'none';
        });
        // Hide section blocks with no visible cards
        sections.forEach(sec => {
          const grid = document.getElementById(sec.grid);
          const visible = grid && grid.querySelectorAll('.menu-card[style*="display: block"]').length > 0;
          document.getElementById(sec.id).style.display = visible ? 'block' : 'none';
        });
        return;
      }
      allCards.forEach(card => {
        const tags = (card.dataset.tags || '').split(',');
        card.style.display = tags.includes(filter) ? 'block' : 'none';
      });
      sections.forEach(sec => {
        const grid = document.getElementById(sec.grid);
        const visible = grid && grid.querySelectorAll('.menu-card[style*="display: block"]').length > 0;
        document.getElementById(sec.id).style.display = visible ? 'block' : 'none';
      });
    }

    // Load menu items (frontend-only)
    function loadMenuItems() {
      // Enhanced menu data with full details
      const menuItems = [
        {
          id: 1,
          title: 'Butter Chicken',
          description: 'Creamy, rich butter chicken with tender pieces of chicken in a tomato-based sauce, served with aromatic basmati rice.',
          image: 'Images/Buter Chicken.jpg',
          category: 'main',
          price: '$12.99',
          type: 'food',
          tags: ['chicken'],
          ingredients: 'Chicken breast, tomatoes, cream, butter, garam masala, fenugreek, ginger, garlic, onions, cashews',
          prepTime: '25-30 minutes',
          nutrition: {
            calories: '450',
            protein: '28g',
            carbs: '12g',
            fat: '32g'
          }
        },
        {
          id: 2,
          title: 'Chicken Curry',
          description: 'Spicy chicken curry with aromatic spices and herbs, a perfect blend of heat and flavor.',
          image: 'Images/Chicken curry.jpg',
          category: 'main',
          price: '$11.99',
          type: 'food',
          tags: ['chicken'],
          ingredients: 'Chicken thighs, curry powder, turmeric, cumin, coriander, chili, coconut milk, tomatoes, onions',
          prepTime: '20-25 minutes',
          nutrition: {
            calories: '380',
            protein: '26g',
            carbs: '8g',
            fat: '28g'
          }
        },
        {
          id: 3,
          title: 'Crispy Chilli Chicken',
          description: 'Crispy fried chicken with sweet and spicy chili sauce, a crowd favorite with perfect crunch.',
          image: 'Images/Crispy Chilli Chicken.jpg',
          category: 'main',
          price: '$13.99',
          type: 'food',
          tags: ['chicken'],
          ingredients: 'Chicken breast, cornstarch, soy sauce, chili sauce, honey, garlic, ginger, green onions, sesame seeds',
          prepTime: '15-20 minutes',
          nutrition: {
            calories: '520',
            protein: '32g',
            carbs: '45g',
            fat: '24g'
          }
        },
        {
          id: 4,
          title: 'Spring Rolls',
          description: 'Fresh vegetable spring rolls with crispy wrapper, served with sweet chili sauce.',
          image: 'Images/spring rolls.jpg',
          category: 'appetizer',
          price: '$6.99',
          type: 'food',
          tags: ['appetizers'],
          ingredients: 'Rice paper, carrots, cucumber, lettuce, mint, cilantro, rice vermicelli, shrimp, peanut sauce',
          prepTime: '10-15 minutes',
          nutrition: {
            calories: '180',
            protein: '8g',
            carbs: '28g',
            fat: '6g'
          }
        },
        {
          id: 5,
          title: 'Chocolate Lava Cake',
          description: 'Warm chocolate cake with molten center, served with vanilla ice cream.',
          image: 'Images/chocolate lava cake.jpg',
          category: 'dessert',
          price: '$8.99',
          type: 'food',
          tags: ['desserts','chocolate'],
          ingredients: 'Dark chocolate, butter, eggs, sugar, flour, vanilla extract, cocoa powder, vanilla ice cream',
          prepTime: '12-15 minutes',
          nutrition: {
            calories: '420',
            protein: '6g',
            carbs: '52g',
            fat: '22g'
          }
        },
        {
          id: 6,
          title: 'Iced Coffee',
          description: 'Smooth cold brew coffee with cream and vanilla, perfect for hot days.',
          image: 'Images/ice coffee.jpg',
          category: 'beverage',
          price: '$4.99',
          type: 'drink',
          tags: ['brewed'],
          ingredients: 'Cold brew coffee, heavy cream, vanilla syrup, ice, whipped cream, chocolate shavings',
          prepTime: '5 minutes',
          nutrition: {
            calories: '180',
            protein: '2g',
            carbs: '18g',
            fat: '12g'
          }
        },
        {
          id: 7,
          title: 'Milk tea',
          description: 'Milk tea is a popular beverage made by combining tea with milk, sugar, and often ice.',          
          image: 'Images/milk tea.jpg',
          category: 'beverage',
           price: '$4.99',
          type: 'drink',
          tags: ['tea'],
          ingredients: 'Tea, milk, sweeterner, ice (optional), flavoring',
           prepTime: '5 minutes',
          nutrition: {
            calories: '180',
            protein: '2g',
            carbs: '18g',
            fat: '12g'
          }
      
        },
        {
          id: 8,
          title: 'Pickled Carrots',
          description: 'Crunchy and tangy pickled carrots, perfect as a side dish or topping for salads and sandwiches.',
          image: 'Images/Pickled Carrots.jpg',
          category: 'appetizer',
          price: '$3.99',
          type: 'food',
          tags: ['appetizers','fruits'],
          ingredients: 'Carrots, vinegar, sugar, salt, garlic, spices',
          prepTime: '10 minutes',
          nutrition: {
            calories: '50',
            protein: '1g',
            carbs: '12g',
            fat: '0g'
          }
        },
        {
          id: 9,
          title: 'Coffee jelly',
          description: 'Coffee jelly is a dessert made from coffee-flavored gelatin, often served with cream or milk.',
          image: 'Images/Coffee jelly.jpg',
          category: 'dessert',
          price: '$5.99',
          type: 'food',
          tags: ['desserts'],
          ingredients: 'Coffee, gelatin, sugar, water, cream (optional)',
          prepTime: '4-6 hours (including chilling time)',
          nutrition: {
            calories: '120',
            protein: '2g',
            carbs: '24g',
            fat: '0g'
          }
        },
        {
          id: 10,
          title: 'mocha cheesecake',
          description: 'A rich and creamy cheesecake with a coffee and chocolate flavor, topped with a mocha ganache.',
          image: 'Images/mocha cheesecake.jpg',
          category: 'dessert',
          price: '$7.99',
          type: 'food',
          tags: ['desserts','chocolate'],
          ingredients: 'Cream cheese, coffee, chocolate, sugar, eggs, graham cracker crust',
          prepTime: '1 hour (plus chilling time)',
          nutrition: {
            calories: '350',
            protein: '6g',
            carbs: '40g',
            fat: '20g'
          }
        },
        {
          id: 11,
          title: 'Mini Spaghetti and Meatballs',
          description: 'A classic Italian dish with spaghetti pasta and homemade meatballs in marinara sauce.',
          image: 'Images/Mini Spaghetti and Meatball.jpg',
          category: 'appetizer',
          price: '$8.99',
          type: 'food',
          tags: ['appetizers','beef'],
          ingredients: 'Spaghetti, ground beef, breadcrumbs, egg, marinara sauce, Parmesan cheese',
          prepTime: '30 minutes',
          nutrition: {
            calories: '400',
            protein: '20g',
            carbs: '50g',
            fat: '15g'
          }
        },
        {
          id: 12,
          title: 'Cappuccino',
          description: 'A classic Italian coffee drink made with espresso, steamed milk, and a layer of frothed milk on top.',
          image: 'Images/Cappuccino.jpg',
          category: 'beverage',
          price: '$3.99',
          type: 'drink',
          tags: ['brewed'],
          ingredients: 'Espresso, steamed milk, frothed milk, cocoa powder (optional)',
          prepTime: '5 minutes',
          nutrition: {
            calories: '120',
            protein: '6g',
            carbs: '12g',
            fat: '6g'
          }
        },
        {
          id: 13,
          title: 'americano',
          description: 'A simple and strong coffee drink made by diluting espresso with hot water.',  
          image: 'Images/americano.jpg',
          category: 'beverage',
          price: '$2.99',
          type: 'drink',
          tags: ['brewed'],
          ingredients: 'Espresso, hot water',
          prepTime: '2 minutes',
          nutrition: {
            calories: '5',
            protein: '0g',
            carbs: '1g',
            fat: '0g'
          }
        }
      ];

      // Populate each category grid
      populateGrid('mainGrid', menuItems.filter(item => item.category === 'main'));
      populateGrid('appetizerGrid', menuItems.filter(item => item.category === 'appetizer'));
      populateGrid('dessertGrid', menuItems.filter(item => item.category === 'dessert'));
      populateGrid('beverageGrid', menuItems.filter(item => item.category === 'beverage'));
    }

    // Populate grid with items
    function populateGrid(gridId, items) {
      const grid = document.getElementById(gridId);
      if (!grid) return;
      
      grid.innerHTML = items.map(item => `
        <div class="menu-card" data-type="${item.type}" data-tags="${(item.tags||[]).join(',')}" onclick="openModal(${item.id})">
          <div class="card-image-container">
            <img src="${item.image}" class="card-image" alt="${item.title}">
          </div>
          <div class="card-body">
            <h5 class="card-title">${item.title}</h5>
            <p class="card-text">${item.description}</p>
            <div class="card-footer">
              <span class="price">${item.price}</span>
              <span class="category-badge">${item.category}</span>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Open modal with full dish details
    function openModal(itemId) {
      // Find the item data
      const allItems = [
        {
          id: 1,
          title: 'Butter Chicken',
          description: 'Creamy, rich butter chicken with tender pieces of chicken in a tomato-based sauce, served with aromatic basmati rice.',
          image: 'Images/Buter Chicken.jpg',
          category: 'main',
          price: '$12.99',
          ingredients: 'Chicken breast, tomatoes, cream, butter, garam masala, fenugreek, ginger, garlic, onions, cashews',
          prepTime: '25-30 minutes',
          nutrition: {
            calories: '450',
            protein: '28g',
            carbs: '12g',
            fat: '32g'
          }
        },
        {
          id: 2,
          title: 'Chicken Curry',
          description: 'Spicy chicken curry with aromatic spices and herbs, a perfect blend of heat and flavor.',
          image: 'Images/Chicken curry.jpg',
          category: 'main',
          price: '$11.99',
          ingredients: 'Chicken thighs, curry powder, turmeric, cumin, coriander, chili, coconut milk, tomatoes, onions',
          prepTime: '20-25 minutes',
          nutrition: {
            calories: '380',
            protein: '26g',
            carbs: '8g',
            fat: '28g'
          }
        },
        {
          id: 3,
          title: 'Crispy Chilli Chicken',
          description: 'Crispy fried chicken with sweet and spicy chili sauce, a crowd favorite with perfect crunch.',
          image: 'Images/Crispy Chilli Chicken.jpg',
          category: 'main',
          price: '$13.99',
          ingredients: 'Chicken breast, cornstarch, soy sauce, chili sauce, honey, garlic, ginger, green onions, sesame seeds',
          prepTime: '15-20 minutes',
          nutrition: {
            calories: '520',
            protein: '32g',
            carbs: '45g',
            fat: '24g'
          }
        },
        {
          id: 4,
          title: 'Spring Rolls',
          description: 'Fresh vegetable spring rolls with crispy wrapper, served with sweet chili sauce.',
          image: 'Images/feature.jpg',
          category: 'appetizer',
          price: '$6.99',
          ingredients: 'Rice paper, carrots, cucumber, lettuce, mint, cilantro, rice vermicelli, shrimp, peanut sauce',
          prepTime: '10-15 minutes',
          nutrition: {
            calories: '180',
            protein: '8g',
            carbs: '28g',
            fat: '6g'
          }
        },
        {
          id: 5,
          title: 'Chocolate Lava Cake',
          description: 'Warm chocolate cake with molten center, served with vanilla ice cream.',
          image: 'Images/chocolate lava cake.jpg',
          category: 'dessert',
          price: '$8.99',
          ingredients: 'Dark chocolate, butter, eggs, sugar, flour, vanilla extract, cocoa powder, vanilla ice cream',
          prepTime: '12-15 minutes',
          nutrition: {
            calories: '420',
            protein: '6g',
            carbs: '52g',
            fat: '22g'
          }
        },
        {
          id: 6,
          title: 'Iced Coffee',
          description: 'Smooth cold brew coffee with cream and vanilla, perfect for hot days.',
         image: 'Images/ice coffee.jpg',
          category: 'beverage',
          price: '$4.99',
          ingredients: 'Cold brew coffee, heavy cream, vanilla syrup, ice, whipped cream, chocolate shavings',
          prepTime: '5 minutes',
          nutrition: {
            calories: '180',
            protein: '2g',
            carbs: '18g',
            fat: '12g'
          }
        },
         {
          id: 7,
          title: 'Milk tea',
          description: 'Milk tea is a popular beverage made by combining tea with milk, sugar, and often ice.',
          image: 'Images/milk tea.jpg',
          category: 'beverage',
          price: '$4.99',
          ingredients: 'Cold brew coffee, heavy cream, vanilla syrup, ice, whipped cream, chocolate shavings',
          prepTime: '5 minutes',
          nutrition: {
            calories: '180'
          }
        },
        { 
          id: 8,
          title: 'Pickled Carrots',
          description: 'Crunchy and tangy pickled carrots, perfect as a side dish or topping for salads and sandwiches.',
          image: 'Images/Pickled Carrots.jpg',
          category: 'appetizer',
          price: '$3.99',
          ingredients:  'carrots, white vinegar, water, sugar, garlic, salt, black pepper, allspice berries',
          prepTime: '10 minutes',
          nutrition: {
            calories: '54'
          }
        },
        {
          id: 9,
          title: 'Coffee jelly',
          description: 'Coffee jelly is a dessert made from coffee-flavored gelatin, often served with cream or milk.',
          image: 'Images/Coffee jelly.jpg',
          category: 'dessert',
          price: '$5.99',
          ingredients: 'Coffee, gelatin, sugar, water, cream (optional)',
          prepTime: '4-6 hours (including chilling time)',
          nutrition: {
            calories: '120'
          }
        },
        {
          id: 10,
          title: 'mocha cheesecake',
          description: 'A rich and creamy cheesecake with a coffee and chocolate flavor, topped with a mocha ganache.',
          image: 'Images/mocha cheesecake.jpg',
          category: 'dessert',
          price: '$7.99',
          ingredients: 'Cream cheese, coffee, chocolate, sugar, eggs, graham cracker crust',
          prepTime: '1 hour (plus chilling time)',
          nutrition: {
            calories: '350',
            protein: '6g',
            carbs: '40g',
            fat: '20g'
          }
        },
        {
          id: 11,
          title: 'Mini Spaghetti and Meatballs',
          description: 'A classic Italian dish with spaghetti pasta and homemade meatballs in marinara sauce.',
          image: 'Images/Mini Spaghetti and Meatball.jpg',
          category: 'appetizer',
          price: '$8.99',
          ingredients: 'Spaghetti, ground beef, breadcrumbs, egg, marinara sauce, Parmesan cheese',
          prepTime: '30 minutes',
          nutrition: {
            calories: '400',
            protein: '20g',
            carbs: '50g',
            fat: '15g'
          }
        },
        {
          id: 12,
          title: 'Cappuccino',
          description: 'A classic Italian coffee drink made with espresso, steamed milk, and a layer of frothed milk on top.',
          image: 'Images/Cappuccino.jpg',
          category: 'beverage',
          price: '$3.99',
          ingredients: 'Espresso, steamed milk, frothed milk, cocoa powder (optional)',
          prepTime: '5 minutes',
          nutrition: {
            calories: '120',
            protein: '6g',
            carbs: '12g',
            fat: '6g'
          }
        },
        {
          id: 13,
          title: 'americano',
          description: 'A simple and strong coffee drink made by diluting espresso with hot water.',  
          image: 'Images/americano.jpg',
          category: 'beverage',
          price: '$2.99',
          ingredients: 'Espresso, hot water',
          prepTime: '2 minutes',
          nutrition: {
            calories: '5',
            protein: '0g',
            carbs: '1g',
            fat: '0g'
          }
        }
      ];
      
      const item = allItems.find(i => i.id === itemId);
      if (!item) return;

      // Populate modal for selected item

      // Populate modal with item details
      document.getElementById('modalImg').src = item.image;
      document.getElementById('modalItemTitle').textContent = item.title;
      document.getElementById('modalDesc').textContent = item.description;
      // Calories only
      const calories = item.nutrition && item.nutrition.calories ? item.nutrition.calories : '';
      const caloriesEl = document.getElementById('modalCalories');
      if (caloriesEl) caloriesEl.textContent = calories;

      // Suggestions (3 random different items from same category/type when possible)
      const allItemsForSuggestions = (window.__allItemsCache || []).length ? window.__allItemsCache : (window.__allItemsCache = [
        ...document.querySelectorAll('.menu-card')
      ].map(card => ({
        id: parseInt(card.getAttribute('onclick').match(/openModal\((\d+)\)/)[1]),
        title: card.querySelector('.card-title').textContent,
        image: card.querySelector('img').getAttribute('src'),
      })));
      const suggestionsRow = document.getElementById('suggestionsRow');
      if (suggestionsRow) {
        // Fallback: pick first 3 different from current id
        const suggestions = allItemsForSuggestions.filter(s => s.id !== item.id).slice(0, 3);
        suggestionsRow.innerHTML = suggestions.map(s => `
          <div class="col-4">
            <div class="suggest-card" onclick="openModal(${s.id})">
              <div class="suggest-img">
                <img src="${s.image}" alt="${s.title}">
              </div>
              <div class="suggest-title">${s.title}</div>
            </div>
          </div>
        `).join('');
      }
      // Show modal
      // Ensure only one backdrop by hiding any existing instance
      const existing = bootstrap.Modal.getInstance(document.getElementById('modal'));
      if (existing) existing.hide();
      const modal = new bootstrap.Modal(document.getElementById('modal'), { backdrop: true });
      modal.show();
    }

    // Search functionality
    document.getElementById('Search').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const allCards = document.querySelectorAll('.menu-card');
      
      allCards.forEach(card => {
        const title = card.querySelector('.card-title').textContent.toLowerCase();
        const description = card.querySelector('.card-text').textContent.toLowerCase();
        
        if (title.includes(searchTerm) || description.includes(searchTerm)) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    });

    // Removed add-to-cart/favorites and buy-now features from modal for cleaner UI

    // Update cart count in UI
    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
      
      // Update cart count display if it exists
      const cartCountElement = document.getElementById('cartCount');
      if (cartCountElement) {
        cartCountElement.textContent = cartCount;
      }
    }

    // Update favorites count in UI
    function updateFavoritesCount() {
      const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
      const favoritesCount = favorites.length;
      
      // Update favorites count display if it exists
      const favoritesCountElement = document.getElementById('favoritesCount');
      if (favoritesCountElement) {
        favoritesCountElement.textContent = favoritesCount;
      }
    }

    // Removed legacy cart/favorites alert drawers for cleaner code


  </script>
</body>
</html>