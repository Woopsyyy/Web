<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brewlen's Cafe - Welcome to Excellence</title>
    <link href="Bootstrap/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="Bootstrap/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <img src="Images/cafe logo.jpg" alt="Josh's Cafe" class="navbar-img" style="width: 50px; height: 50px; object-fit: cover;">
      </a>
      
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="menu.html">MENU</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="branch.html">BRANCH</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">ABOUT</a>
          </li>
        </ul>
        
        <div class="navbar-nav" id="authSection">
          <!-- This will be populated by JavaScript based on auth status -->
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <div class="hero-section">
    <div class="container">
      <div class="row align-items-center min-vh-100">
        <div class="col-lg-6">
          <h1 class="display-4 fw-bold text-white mb-4">
            <span class="d-block">WELCOME TO</span>
            <span class="d-block">BREWLEN'S CAFE</span>
          </h1>
          <p class="lead text-white mb-4 opacity-75">Savor the perfect mix of comfort and creativity in every sip and bite.
At our cafe, every cup and plate is crafted with passion, quality, and a touch of artistryâ€”making each visit a delicious story worth sharing.</p>
          <div class="d-flex gap-3">
            <a href="menu.html" class="btn btn-cafe-outline-light">
              <i class="bi bi-utensils me-2"></i>Explore Menu
            </a>
            <a href="branch.html" class="btn btn-cafe-outline-light">
              <i class="bi bi-geo-alt me-2"></i>Find Us
            </a>
          </div>
        </div>
        <div class="col-lg-6 text-center">
          <img src="Images/logo2.png" alt="Best Seller" class="img-fluid rounded hero-image">
        </div>
      </div>
    </div>
  </div>

  <!-- Features Section -->
  <div class="container py-5">
    <div class="row text-center mb-5">
      <div class="col-12">
        <h2 class="display-5 fw-bold text-dark mb-3">Why Choose Brewlen's Cafe?</h2>
        <p class="lead text-muted">Discover what makes us special and why our customers keep coming back</p>
      </div>
    </div>
    
    <div class="row g-4">
      <div class="col-lg-4">
        <div class="feature-card text-center">
          <div class="feature-icon mb-4">
            <i class="bi bi-utensils text-primary" style="font-size: 3rem;"></i>
          </div>
          <h4 class="mb-3">Fresh Ingredients</h4>
          <p class="text-muted mb-4">We source only the finest, freshest ingredients to ensure every dish exceeds your expectations.</p>
          <a href="menu.html" class="btn btn-cafe w-100">
            <i class="bi bi-arrow-right me-2"></i>View Menu
          </a>
        </div>
      </div>
      
      <div class="col-lg-4">
        <div class="feature-card text-center">
          <div class="feature-icon mb-4">
            <i class="bi bi-heart text-primary" style="font-size: 3rem;"></i>
          </div>
          <h4 class="mb-3">Made with Love</h4>
          <p class="text-muted mb-4">Every dish is prepared with care and attention to detail, ensuring a memorable dining experience.</p>
          <a href="about.html" class="btn btn-cafe w-100">
            <i class="bi bi-arrow-right me-2"></i>Our Story
          </a>
        </div>
      </div>
      
      <div class="col-lg-4">
        <div class="feature-card text-center">
          <div class="feature-icon mb-4">
            <i class="bi bi-geo-alt text-primary" style="font-size: 3rem;"></i>
          </div>
          <h4 class="mb-3">Multiple Locations</h4>
          <p class="text-muted mb-4">Visit any of our conveniently located branches and enjoy the same quality and service everywhere.</p>
          <a href="branch.html" class="btn btn-cafe w-100">
            <i class="bi bi-arrow-right me-2"></i>Find Branches
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Highlights: Signature Sips -->
  <div class="menu-container" style="background: #fff;">
    <div class="container py-5">
      <h2 class="section-title mb-4">Signature Sips</h2>
      <div class="menu-grid">
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/americano.jpg" class="card-image" alt="Americano">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Americano</h5>
            </div>
          </div>
        </a>
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/Cappuccino.jpg" class="card-image" alt="Cappuccino">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Cappuccino</h5>
            </div>
          </div>
        </a>
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/ice coffee.jpg" class="card-image" alt="Iced Coffee">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Iced Coffee</h5>
            </div>
          </div>
        </a>
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/milk tea.jpg" class="card-image" alt="Milk Tea">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Milk Tea</h5>
            </div>
          </div>
        </a>
      </div>
      <div class="text-center mt-4">
        <a href="menu.html" class="btn btn-cafe"><i class="bi bi-cup-hot me-2"></i>See All Drinks</a>
      </div>
    </div>
  </div>

  <!-- Highlights: From Our Kitchen -->
  <div class="menu-container" style="background: #f8f9fa;">
    <div class="container py-5">
      <h2 class="section-title mb-4">From Our Kitchen</h2>
      <div class="menu-grid">
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/Buter Chicken.jpg" class="card-image" alt="Butter Chicken">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Butter Chicken</h5>
            </div>
          </div>
        </a>
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/Crispy Chilli Chicken.jpg" class="card-image" alt="Crispy Chilli Chicken">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Crispy Chilli Chicken</h5>
            </div>
          </div>
        </a>
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/chocolate lava cake.jpg" class="card-image" alt="Chocolate Lava Cake">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Chocolate Lava Cake</h5>
            </div>
          </div>
        </a>
        <a href="menu.html" class="text-decoration-none">
          <div class="menu-card">
            <div class="card-image-container">
              <img src="Images/Coffee jelly.jpg" class="card-image" alt="Coffee Jelly">
            </div>
            <div class="card-body">
              <h5 class="card-title text-center">Coffee Jelly</h5>
            </div>
          </div>
        </a>
      </div>
      <div class="text-center mt-4">
        <a href="menu.html" class="btn btn-cafe-outline"><i class="bi bi-egg-fried me-2"></i>Browse All Dishes</a>
      </div>
    </div>
  </div>

  <!-- Visit Us CTA -->
  <div class="container py-5">
    <div class="cta-section p-4 text-center">
      <h3 class="mb-2">Drop by for a cozy break</h3>
      <p class="mb-4">Find a Brewlen's Cafe near you and enjoy your favorites fresh.</p>
      <a href="branch.html" class="btn btn-cafe"><i class="bi bi-geo-alt me-2"></i>Find Nearest Branch</a>
    </div>
  </div>

  <!-- Removed Seasonal Promos, Testimonials, Gallery for a cleaner layout per request -->


  <!-- Special Offer Section -->
  <div class="container py-5">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        <div class="newsletter-section">
          <h4 class="mb-3">Special Offer!</h4>
          <p class="mb-3">Join our loyalty program and get exclusive discounts, early access to new menu items, and special birthday treats!</p>
          <button class="btn btn-primary btn-lg">
            <i class="bi bi-gift me-2"></i>Join Now
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback Section -->
  <div class="container py-5">
    <div class="row">
      <div class="col-lg-8 mx-auto">
        <div class="feedback-section text-center">
          <h4 class="mb-3">We'd Love to Hear From You!</h4>
          <p class="mb-4">Share your experience with us and help us improve our service</p>
          <div class="row g-3">
            <div class="col-md-6">
              <div class="feedback-card p-4 bg-light rounded">
                <i class="fas fa-star text-warning mb-3" style="font-size: 2rem;"></i>
                <h5>Rate Your Experience</h5>
                <p class="text-muted">Tell us how we're doing</p>
                <button class="btn btn-outline-primary" onclick="openRatingModal()">Rate Now</button>
              </div>
            </div>
            <div class="col-md-6">
              <div class="feedback-card p-4 bg-light rounded">
                <i class="fas fa-comment text-info mb-3" style="font-size: 2rem;"></i>
                <h5>Send Feedback</h5>
                <p class="text-muted">Share your thoughts with us</p>
                <button class="btn btn-outline-info" onclick="openFeedbackModal()">Send Message</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Rating Modal -->
  <div class="modal fade" id="ratingModal" tabindex="-1" aria-labelledby="ratingModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="ratingModalLabel">Rate Your Experience</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-3">
            <h6>How would you rate your experience?</h6>
            <div class="rating-stars mb-3">
              <i class="fas fa-star star-rating" data-rating="1" style="font-size: 2rem; color: #ddd; cursor: pointer; margin: 0 5px;"></i>
              <i class="fas fa-star star-rating" data-rating="2" style="font-size: 2rem; color: #ddd; cursor: pointer; margin: 0 5px;"></i>
              <i class="fas fa-star star-rating" data-rating="3" style="font-size: 2rem; color: #ddd; cursor: pointer; margin: 0 5px;"></i>
              <i class="fas fa-star star-rating" data-rating="4" style="font-size: 2rem; color: #ddd; cursor: pointer; margin: 0 5px;"></i>
              <i class="fas fa-star star-rating" data-rating="5" style="font-size: 2rem; color: #ddd; cursor: pointer; margin: 0 5px;"></i>
            </div>
            <div id="ratingText" class="text-muted">Select a rating</div>
          </div>
          <div class="mb-3">
            <label for="ratingMessage" class="form-label">Additional Comments (Optional)</label>
            <textarea class="form-control" id="ratingMessage" rows="3" placeholder="Tell us more about your experience..."></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="submitRating()">Submit Rating</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback Modal -->
  <div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="feedbackModalLabel">Send Feedback</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="feedbackMessage" class="form-label">Your Feedback</label>
            <textarea class="form-control" id="feedbackMessage" rows="5" placeholder="Share your thoughts, suggestions, or any feedback you have for us..."></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="submitFeedback()">Send Feedback</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="Bootstrap/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
  
  <!-- Authentication Script -->
  <script>
    // Check authentication status on page load
    document.addEventListener('DOMContentLoaded', function() {
      checkAuthStatus();
    });

    // Check if user is authenticated
    async function checkAuthStatus() {
      try {
        // Add cache-busting parameter
        const response = await fetch('Backend/auth/auth_me.php?t=' + Date.now());
        const result = await response.json();
        
        if (result.user) {
          // User is logged in
          showAuthenticatedUser(result.user);
        } else {
          // Require login before accessing the app
          window.location.href = 'login.html';
          return;
        }
      } catch (error) {
        console.error('Auth check error:', error);
        window.location.href = 'login.html';
      }
    }

    // Show authenticated user section
    function showAuthenticatedUser(user) {
      const authSection = document.getElementById('authSection');
      let adminLink = '';
      
      if (user.role === 'admin') {
        adminLink = '<li><a class="dropdown-item" href="admin.html"><i class="fas fa-cog me-2"></i>Admin Panel</a></li><li><hr class="dropdown-divider"></li>';
      }
      
      authSection.innerHTML = `
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
            <i class="fas fa-user-circle" style="font-size: 1.5rem; color: #666;"></i>
          </a>
          <ul class="dropdown-menu">
            ${adminLink}
            <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
          </ul>
        </div>
      `;
    }

    // Show login/signup buttons (unused due to hard redirect)
    function showLoginButtons() {
      const authSection = document.getElementById('authSection');
      authSection.innerHTML = `
        <a class="nav-link" href="login.html">Login</a>
      `;
    }

    // Logout function -> always return to login page
    async function logout() {
      try {
        const response = await fetch('Backend/auth/auth_logout.php', {
          method: 'POST'
        });
        
        const result = await response.json();
        // Clear any cached data and redirect immediately
        localStorage.removeItem('user');
        sessionStorage.clear();
        window.location.replace('login.html');
      } catch (error) {
        console.error('Logout error:', error);
        // Clear any cached data and redirect even on error
        localStorage.removeItem('user');
        sessionStorage.clear();
        window.location.replace('login.html');
      }
    }

    // Rating and Feedback functionality
    let selectedRating = 0;

    function openRatingModal() {
      const modal = new bootstrap.Modal(document.getElementById('ratingModal'));
      modal.show();
      resetRating();
    }

    function openFeedbackModal() {
      const modal = new bootstrap.Modal(document.getElementById('feedbackModal'));
      modal.show();
      document.getElementById('feedbackMessage').value = '';
    }

    function resetRating() {
      selectedRating = 0;
      const stars = document.querySelectorAll('.star-rating');
      const ratingText = document.getElementById('ratingText');
      
      stars.forEach(star => {
        star.style.color = '#ddd';
      });
      ratingText.textContent = 'Select a rating';
    }

    // Initialize star rating functionality
    document.addEventListener('DOMContentLoaded', function() {
      const stars = document.querySelectorAll('.star-rating');
      
      stars.forEach(star => {
        star.addEventListener('click', function() {
          const rating = parseInt(this.getAttribute('data-rating'));
          selectedRating = rating;
          
          // Update star colors
          stars.forEach((s, index) => {
            if (index < rating) {
              s.style.color = '#ffc107';
            } else {
              s.style.color = '#ddd';
            }
          });
          
          // Update rating text
          const ratingText = document.getElementById('ratingText');
          const ratingLabels = ['', 'Poor', 'Fair', 'Good', 'Very Good', 'Excellent'];
          ratingText.textContent = ratingLabels[rating];
        });
        
        // Hover effects
        star.addEventListener('mouseenter', function() {
          const rating = parseInt(this.getAttribute('data-rating'));
          stars.forEach((s, index) => {
            if (index < rating) {
              s.style.color = '#ffc107';
            }
          });
        });
        
        star.addEventListener('mouseleave', function() {
          stars.forEach((s, index) => {
            if (index < selectedRating) {
              s.style.color = '#ffc107';
            } else {
              s.style.color = '#ddd';
            }
          });
        });
      });
    });

    async function submitRating() {
      if (selectedRating === 0) {
        alert('Please select a rating before submitting.');
        return;
      }

      const message = document.getElementById('ratingMessage').value;
      
      try {
        const response = await fetch('Backend/feedback/feedback.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            type: 'rating',
            rating: selectedRating,
            message: message
          })
        });

        const result = await response.json();
        
        if (result.success) {
          alert('Thank you for your rating!');
          const modal = bootstrap.Modal.getInstance(document.getElementById('ratingModal'));
          modal.hide();
          resetRating();
        } else {
          alert('Error: ' + (result.error || 'Failed to submit rating'));
        }
      } catch (error) {
        console.error('Rating submission error:', error);
        alert('Failed to submit rating. Please try again.');
      }
    }

    async function submitFeedback() {
      const message = document.getElementById('feedbackMessage').value.trim();
      
      if (!message) {
        alert('Please enter your feedback before submitting.');
        return;
      }

      try {
        const response = await fetch('Backend/feedback/feedback.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            type: 'feedback',
            message: message
          })
        });

        const result = await response.json();
        
        if (result.success) {
          alert('Thank you for your feedback!');
          const modal = bootstrap.Modal.getInstance(document.getElementById('feedbackModal'));
          modal.hide();
          document.getElementById('feedbackMessage').value = '';
        } else {
          alert('Error: ' + (result.error || 'Failed to submit feedback'));
        }
      } catch (error) {
        console.error('Feedback submission error:', error);
        alert('Failed to submit feedback. Please try again.');
      }
    }
  </script>
</body>
</html>






